{"metadata":{"symbolKind":"struct","navigatorTitle":[{"text":"CodePointDatabase","kind":"identifier"}],"roleHeading":"Structure","role":"symbol","modules":[{"name":"UnicodeDataStructures"}],"externalID":"s:21UnicodeDataStructures17CodePointDatabaseV","title":"CodePointDatabase","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CodePointDatabase","kind":"identifier"}]},"hierarchy":{"paths":[["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures"]]},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase"},"abstract":[{"text":"An immutable database of information about Unicode code-points.","type":"text"}],"schemaVersion":{"patch":0,"major":0,"minor":3},"topicSections":[{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/BMPIndex"],"title":"Structures"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/init(asciiData:bmpIndex:bmpData:nonbmpData:)"],"title":"Initializers"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/subscript(_:)"],"title":"Subscripts"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/SplitTable"],"title":"Type Aliases"},{"identifiers":["doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/LookupResult"],"title":"Enumerations"}],"primaryContentSections":[{"kind":"declarations","declarations":[{"platforms":["Linux"],"languages":["swift"],"tokens":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"CodePointDatabase"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"Schema"},{"kind":"text","text":"> "},{"kind":"keyword","text":"where"},{"kind":"text","text":" "},{"kind":"typeIdentifier","text":"Schema"},{"kind":"text","text":" : "},{"preciseIdentifier":"s:21UnicodeDataStructures24CodePointDatabase_SchemaP","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase_Schema","kind":"typeIdentifier","text":"CodePointDatabase_Schema"}]}]},{"kind":"content","content":[{"text":"Overview","anchor":"overview","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"Databases can be constructed using a "},{"type":"codeVoice","code":"CodePointDatabase.Builder"},{"type":"text","text":", after which they may be queried,"},{"text":" ","type":"text"},{"text":"or printed as a Swift source file.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Data is stored in 3 sections:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A direct lookup for ASCII code-points, to values of the "},{"type":"codeVoice","code":"Schema.ASCIIData"},{"type":"text","text":" type."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A 2-stage, indexed lookup for BMP code-points, to values of the "},{"type":"codeVoice","code":"Schema.UnicodeData"},{"type":"text","text":" type."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The top N bits of the code-point are indexed, where N is chosen by the Schema."},{"type":"text","text":" "},{"type":"text","text":"This means a O(1), branchless reduction in the search space to a block of entries covering 2^(16 - N) code-points."},{"type":"text","text":" "},{"type":"text","text":"For a list of "},{"code":"n","type":"codeVoice"},{"type":"text","text":" elements, a binary-search requires a maximum of "},{"code":"log2(n)","type":"codeVoice"},{"type":"text","text":" comparisons,"},{"type":"text","text":" "},{"type":"text","text":"meaning that in the worst case, when every code-point has an individual data entry, we would need a maximum"},{"type":"text","text":" "},{"type":"text","text":"of (16 - N) comparisons to locate the data for an arbitrary code-point."}]},{"type":"paragraph","inlineContent":[{"text":"Often it will be much fewer than that, because the data entries are grouped in to regions.","type":"text"},{"text":" ","type":"text"},{"text":"For example, the IDNA mapping table has about 4000 entries for all 2^16 code-points in the BMP.","type":"text"},{"text":" ","type":"text"},{"text":"Code-point and data tables are split to avoid padding and improve cache performance.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Per-plane binary-searched tables for non-BMP code-points, to values of the "},{"type":"codeVoice","code":"Schema.UnicodeData"},{"type":"text","text":" type."}]},{"type":"paragraph","inlineContent":[{"text":"Most planes outside the BMP are ","type":"text"},{"identifier":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","type":"reference","isActive":true},{"text":", but","type":"text"},{"text":" ","type":"text"},{"text":"the ones that are include plane 1, the SMP (mostly historic scripts and emoji), and planes 2 and 3 -","type":"text"},{"text":" ","type":"text"},{"text":"the SIP and TIP respectively, containing CJK ideographs.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Per-plane tables means we can represent code-points as 16-bit values, which more efficiently"},{"type":"text","text":" "},{"type":"text","text":"packs their contents and improves cache utilization. Code-point and data tables are split"},{"type":"text","text":" "},{"type":"text","text":"to avoid padding and also improve cache performance."}]}]}],"type":"unorderedList"}]}],"kind":"symbol","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/unicodedatastructures\/codepointdatabase"]}],"sections":[],"references":{"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase_Schema":{"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase_Schema","type":"topic","url":"\/documentation\/unicodedatastructures\/codepointdatabase_schema","role":"symbol","kind":"symbol","navigatorTitle":[{"kind":"identifier","text":"CodePointDatabase_Schema"}],"abstract":[{"type":"text","text":"Describes the data associated with code-points in a "},{"code":"CodePointDatabase","type":"codeVoice"},{"type":"text","text":"."}],"title":"CodePointDatabase_Schema","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"CodePointDatabase_Schema"}]},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/SplitTable":{"kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/SplitTable","navigatorTitle":[{"text":"SplitTable","kind":"identifier"}],"title":"CodePointDatabase.SplitTable","role":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/splittable","fragments":[{"text":"typealias","kind":"keyword"},{"text":" ","kind":"text"},{"text":"SplitTable","kind":"identifier"}],"abstract":[],"type":"topic"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/init(asciiData:bmpIndex:bmpData:nonbmpData:)":{"kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/init(asciiData:bmpIndex:bmpData:nonbmpData:)","title":"init(asciiData:bmpIndex:bmpData:nonbmpData:)","role":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/init(asciidata:bmpindex:bmpdata:nonbmpdata:)","fragments":[{"text":"init","kind":"identifier"},{"text":"(","kind":"text"},{"text":"asciiData","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"ASCIIData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"bmpIndex","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"CodePointDatabase","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"BMPIndex","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV8BMPIndexV","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"IndexStorage","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV8BMPIndexV12IndexStoragea","kind":"typeIdentifier"},{"text":"], ","kind":"text"},{"text":"bmpData","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"CodePointDatabase","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"SplitTable","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV10SplitTablea","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"UInt16","preciseIdentifier":"s:s6UInt16V","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"UnicodeData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":">, ","kind":"text"},{"text":"nonbmpData","kind":"externalParam"},{"text":": [","kind":"text"},{"text":"CodePointDatabase","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"text":"SplitTable","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV10SplitTablea","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"UInt16","preciseIdentifier":"s:s6UInt16V","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"Schema","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"UnicodeData","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"RawStorage","kind":"typeIdentifier"},{"text":">])","kind":"text"}],"abstract":[{"type":"text","text":"Initializes a database from static data."}],"type":"topic"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/subscript(_:)":{"type":"topic","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/subscript(_:)","fragments":[{"text":"subscript","kind":"keyword"},{"text":"(","kind":"text"},{"text":"Unicode","kind":"typeIdentifier","preciseIdentifier":"s:s7UnicodeO"},{"kind":"text","text":"."},{"kind":"typeIdentifier","preciseIdentifier":"s:s7UnicodeO6ScalarV","text":"Scalar"},{"kind":"text","text":") -> "},{"kind":"typeIdentifier","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV","text":"CodePointDatabase"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","text":"Schema"},{"kind":"text","text":">."},{"kind":"typeIdentifier","text":"LookupResult","preciseIdentifier":"s:21UnicodeDataStructures17CodePointDatabaseV12LookupResultO"}],"abstract":[],"role":"symbol","title":"subscript(_:)","conformance":{"availabilityPrefix":[{"type":"text","text":"Available when"}],"constraints":[{"type":"codeVoice","code":"Schema"},{"type":"text","text":" conforms to "},{"code":"CodePointDatabase_Schema","type":"codeVoice"},{"text":".","type":"text"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}]},"kind":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/subscript(_:)"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/BMPIndex":{"kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/BMPIndex","navigatorTitle":[{"text":"BMPIndex","kind":"identifier"}],"title":"CodePointDatabase.BMPIndex","role":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/bmpindex","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"BMPIndex","kind":"identifier"}],"abstract":[],"type":"topic"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures":{"title":"UnicodeDataStructures","kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures","type":"topic","abstract":[],"url":"\/documentation\/unicodedatastructures","role":"collection"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase":{"kind":"symbol","identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase","navigatorTitle":[{"text":"CodePointDatabase","kind":"identifier"}],"title":"CodePointDatabase","role":"symbol","url":"\/documentation\/unicodedatastructures\/codepointdatabase","fragments":[{"text":"struct","kind":"keyword"},{"text":" ","kind":"text"},{"text":"CodePointDatabase","kind":"identifier"}],"abstract":[{"type":"text","text":"An immutable database of information about Unicode code-points."}],"type":"topic"},"doc://com.karwa.WebURL/documentation/UnicodeDataStructures/CodePointDatabase/LookupResult":{"type":"topic","kind":"symbol","navigatorTitle":[{"text":"LookupResult","kind":"identifier"}],"identifier":"doc:\/\/com.karwa.WebURL\/documentation\/UnicodeDataStructures\/CodePointDatabase\/LookupResult","title":"CodePointDatabase.LookupResult","url":"\/documentation\/unicodedatastructures\/codepointdatabase\/lookupresult","abstract":[],"fragments":[{"text":"enum","kind":"keyword"},{"text":" ","kind":"text"},{"text":"LookupResult","kind":"identifier"}],"conformance":{"conformancePrefix":[{"type":"text","text":"Conforms when"}],"constraints":[{"type":"codeVoice","code":"Schema"},{"text":" conforms to ","type":"text"},{"type":"codeVoice","code":"CodePointDatabase_Schema"},{"text":".","type":"text"}],"availabilityPrefix":[{"type":"text","text":"Available when"}]},"role":"symbol"},"https://en.wikipedia.org/wiki/Plane_(Unicode)":{"identifier":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","type":"link","url":"https:\/\/en.wikipedia.org\/wiki\/Plane_(Unicode)","titleInlineContent":[{"type":"text","text":"not assigned"}],"title":"not assigned"}}}